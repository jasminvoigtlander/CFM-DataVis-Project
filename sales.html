<!-- Links -->
<link rel='stylesheet' type='text/css' href='dashboard.css' />
<link rel='stylesheet' type='text/css' href='sales.css' />
<!-- Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="sales.json"></script>
<script type="text/javascript" src="attendance.json"></script>

<div id='header'>
  <div class='content shadow radius-bottom'>
    <div class='padded'>
      <div class='outline'>
        <div class='logo-nav'>
          <div class='logo-nav'>
            <h1 id='logo'>
                <a href='https://cfmatl.org/'><img src='images/logo.png'>
            </h1>
          </div>
          <nav id='navigation'>
            <ul class='menu sf-arrows'>
              <li>
                <a class='sf-with-ul' href='dashboard.html'>Dashboard</a>
              </li>
              <li>
                <div class='dropdown'>
                    <button class='dropbtn' onclick='location.href="sales.html"' type='button'>Sales &#x25BE
                    </button>
                    <div class='dropdown-content sales'>
                      <span class='nav-arrow'></span>
                      <a href='sales.html'>Market</a>
                      <a href='sales.html'>Vendor Category</a>
                    </div>
                </div>
              </li>
              <li>
                  <div class='dropdown'>
                      <button class='dropbtn' onclick='location.href="attendance.html"' type='button'>Attendance &#x25BE
                      </button>
                      <div class='dropdown-content attendance'>
                        <span class='nav-arrow'></span>
                        <a href='attendance.html'>Market</a>
                      </div>
                  </div>
              </li>
              <li>
                <a class='sf-with-ul' href='support.html'>Support</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
<div id='footer'>
  <div class='content shadow radius-top'>
    <div class='padded'>
      <div class='outline'>
        <div class='row'>
          <div class='graphs'>
              <canvas id="myChart" width="1600" height="900"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
var allSalesX = [];
var allSalesY = [];

//Parse Sales JSON
$.getJSON('sales.json', function(data) {  
    var date = '5/8/18';
    var sales = [];
    for (var i = 0; i < data.length; i++) {
      if (data[i].date !== date) {
        allSalesX.push(new Date(date));
        allSalesY.push(sales.reduce(function add(a, b) { return a + b }, 0));
        sales = [];
        date = data[i].date;
      }
      sales.push(data[i].sales);
    }
    allSalesX.push(date);
    allSalesY.push(Math.round(sales.reduce(function add(a, b) { return a + b }), 0));

    //Create All Sales Graph
    var ctx = document.getElementById('myChart');
    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: allSalesX,
          datasets: [{
              fill: false,
              label: 'Sales',
              data: allSalesY,
              borderColor: '#2d8464',
              backgroundColor: '#2d8464',
          }]
        },
        options: {
            fill: false,
            responsive: true,
            scales: {
                xAxes: [{
                    type: 'time',
                    display: true,
                }],
                yAxes: [{
                    ticks: {
                        beginAtZero: true,
                    },
                    display: true,
                }]
            }
        }
    });
});

</script>
