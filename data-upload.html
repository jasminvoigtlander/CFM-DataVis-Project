<!-- Links -->
<link rel='stylesheet' type='text/css' href='dashboard.css' />
<link rel='stylesheet' type='text/css' href='data-upload.css' />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="sales.json"></script>
<script type="text/javascript" src="attendance.json"></script>

<div id='header'>
  <div class='content shadow radius-bottom'>
    <div class='padded'>
      <div class='outline'>
        <div class='logo-nav'>
          <div class='logo-nav'>
            <h1 id='logo'>
                <a href='https://cfmatl.org/'><img src='images/logo.png'>
            </h1>
          </div>
          <nav id='navigation'>
            <span class='menu-toggle'></span>
            <ul class='menu sf-arrows'>
              <li>
                <a class='sf-with-ul' href='dashboard.html'>Dashboard</a>
              </li>
              <li>
                <a class='sf-with-ul' href='graphs.html'>Graphs</a>
              </li>
              <li>
                <a class='sf-with-ul' href='data-upload.html'>Data Upload</a>
              </li>
              <li>
                <a class='sf-with-ul' href='support.html'>Support</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
<div id='footer'>
  <div class='content shadow radius-top'>
    <div class='padded'>
      <div class='outline'>
        <div class='row'>
          <div class='upload-form'>
            <div class="toggle">
              <br>What type of data are you updating?</br>
              <div id= "saleRadio">
                <input id="r1" class="form-radio" type="radio" name="graphs" value="SalesRadio" onchange="salesInputs()"> Sales<br>
              </div>
              <div id = attendanceRadio>
                <input id="r2" class="form-radio" type="radio" name="graphs" value="AttendanceRadio" onchange="attendanceInputs()"> Attendance<br>
              </div>
              <br>
            </div>
              <form id="data-form" hidden>
                <select id='markets' name='market' class='form-item' required>
                  <option value='' disable selected>Market</option>
                  <option value='EAV'>East Atlanta Village</option>
                  <option value='DFM-W'>Decatur (Wednesday)</option>
                  <option value='DFM-S'>Decatur (Saturday)</option>
                  <option value='GPFM'>Grant Park</option>
                  <option value='PCFM-S'>Poncy City</option>
                </select><br>

                <div id="vendorCategory">
                  <select  id='vc' name='vendorCategory' class='form-item' required>
                      <option value='' disable selected>Vendor Category</option>
                      <option value='farmer'>Farmer</option>
                      <option value='food'>Packaged, Processed and Prepared Food Vendor</option>
                      <option value='non-food'>Non-Food Vendor</option>
                    </select><br>
                </div>

                <div id="saleData">
                  <input name='sales' id='sales' class='form-item' placeholder='Sales' required><br>
                </div>
                <div id="attendanceData">
                  <input name='sales' id='attendance' class='form-item' placeholder='Attendance' required><br>
                </div>
                <input id='date' name='date' type ='date' class='form-item' required><br>
                <div class='button-container'>
                  <button type="button" id="myBtnNeg" class='secondary-action' onclick="openModalNeg()">Cancel</button>
                  <button type="button"  id="myBtn" class='primary-action' onclick="openModal()">Upload Data</button>

                </div>
              </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>New data uploaded successfully!</p>
  </div>

</div>

<div id="myModalNeg" class="modal-neg">

  <!-- Modal content -->
  <div class="modal-content-neg">
    <span class="close">&times;</span>
    <p>No new data added.</p>
  </div>

</div>

<script>
  function openModal() {
    // Get the modal
    var modal = document.getElementById('myModal');

    // Get the button that opens the modal
    var btn = document.getElementById("myBtn");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks on the button, open the modal
    btn.onclick = function() {
        modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
  }

  function openModalNeg() {
    // Get the modal
    var modal = document.getElementById('myModalNeg');

    // Get the button that opens the modal
    var btn = document.getElementById("myBtnNeg");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[1];

    // When the user clicks on the button, open the modal
    btn.onclick = function() {
        modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
  }


  function salesInputs() {
      $("#data-form").show();

      var y = document.getElementById('attendanceData');
      y.style.display = "none";

      var x = document.getElementById('vendorCategory');
      x.style.display = "block";

      var z = document.getElementById('saleData');
      z.style.display = "block";

      var a = document.getElementById('vc');
      var b = document.getElementById('attendance');
      var c = document.getElementById('sales');

      a.required = true;
      b.required = false;
      c.required = true;
  }

  function attendanceInputs() {
    $("#data-form").show();
    var x = document.getElementById('vendorCategory');
    var y = document.getElementById('attendanceData');
    var z = document.getElementById('saleData');

    var a = document.getElementById('vc');
    var b = document.getElementById('attendance');
    var c = document.getElementById('sales');

    z.style.display = "none";
    c.required = false;

    x.style.display = "none";
    a.required = false;

    y.style.display = "block";
    b.required = true;


  }

  function saveTo() {
    var sale = document.getElementById('r1');
    var att = document.getElementById('r2');

    if (sale.checked) {
      console.log("SALE UPLOAD");

      var market = document.getElementById('markets');
      var sm = market.options[market.selectedIndex].value;

      var vendor = document.getElementById('vc');
      var sv = vendor.options[vendor.selectedIndex].value;
      var dataNum = document.getElementById('sales').value;
      var date = document.getElementById('date').value;
      date = date.toString();
      date = reformatDate(date);
      dataNum = parseInt(dataNum);

      // console.log(sm);
      // console.log(sv);
      // console.log(dataNum);
      // console.log(date);

      // addSaleData(sm, sv, dataNum, date);

    } else if (att.checked) {
      console.log("ATTENDANCE UPLOAD");
      var market = document.getElementById('markets');
      var sm = market.options[market.selectedIndex].value;
      var dataNum = document.getElementById('attendance').value;
      var date = document.getElementById('date').value;
      date = date.toString();
      date = reformatDate(date);
      dataNum = parseInt(dataNum);

      // console.log(sm);
      // console.log(dataNum);
      // console.log(date.toString());

       // addAttendanceData(sm, dataNum, date);
    }

  }

  function reformatDate(dateString) {
    return dateString.substring(5, 7) + "/" + dateString.substr(8, 2) + "/" + dateString.substring(0, 4);
  }



  // Disable symbols and letters from Sales and Attendance input
  document.getElementById('sales').onkeypress = function(e) {
      var chr = String.fromCharCode(e.which);
      if ('1234567890'.indexOf(chr) < 0)
          return false;
  };
  document.getElementById('attendance').onkeypress = function(e) {
      var chr = String.fromCharCode(e.which);
      if ('1234567890'.indexOf(chr) < 0)
          return false;
  };



</script>
